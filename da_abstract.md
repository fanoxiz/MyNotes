---
title: "Дискретный анализ, 2025"
author: "@witzberg"
date: "2025-12-26"
---

## $\boxed{4.1}$

**Граф** - пара $G = (V, E)$

- $|V| < \infty$
- $E \subset V \times V$

По умолчанию, граф неориентированный $(E = \binom{V}{2})$, без петель и кратных ребер

**Орграф -** ребра упорядочены  
**Мультиграф -** разрешены кратные ребра  
**Псевдограф -** разрешены петли  
**Регулярный -** степени всех вершин равны  
**$\deg v$ -** количество ребер, инцидентных вершине $v$. (Петля добавляет $2$ к степени вершины). Для орграфов $\text{indeg}$ и $\text{outdeg}$

> **Лемма о рукопожатиях**  
> В неориентированном графе:  
> $$ \sum_{v \in V} \deg v = 2|E| $$

**Маршрут -** последовательность $v_1 e_1 \dots v_{n-1} e_{n-1} v_n$, где $e_i = (v_i, v_{i+1}) \in E$  

**Простой путь -** незамкнутый маршрут, все вершины различны  
**Простой цикл -** замкнутый маршрут, все вершины различны, кроме крайних  

**Цепь -** маршрут, все ребра различны  
**Цикл -** замкнутая цепь  

**Эйлеров путь -** цепь, проходящая по всем ребрам  
**Эйлеров цикл -** эйлеров путь, в котором начало и конец совпадают  
**Эйлеров граф -** в котором существует эйлеров цикл  

**Гамильтонов граф -** в котором существует простой цикл, проходящий по всем вершинам

> **Критерии эйлеровости графа**  
> 
> - Для ориентированного:  
> $$ \text{сильно связен* и } \forall v \in V: \text{indeg } v = \text{outdeg } v $$
> 
> - Для неориентированного:  
> $$ \text{связен* и } \forall v \in V: \deg v \equiv 0 \pmod 2 $$  
> 
> *\*С точностью до изолированных вершин*

$\triangle$  

**Для оргарфа**  
Если есть цикл, то в любую вершину входим и выходим $\implies \text{indeg } = \text{outdeg}$. Для любых двух вершин, инцидентных хоть одному ребру, есть путь в обе стороны, т.к. цикл проходит по этим ребрам. Необходимость доказана.

Начнем обход из не изолированной вершины, идем по ребрам без повторений. Каждый раз входя в вершину, мы можем из нее выйти, это неверно только для начальной, поэтому получим цикл. Если цикл не максимальный, то строим по тому же алгоритму еще один цикл, из вершины, инцидентной неиспользованному ребру. По сильной связности, эта вершина принадлежит первому циклу тоже. Значит, два цикла можно склеить.

**Для графа**  

Аналогично

## $\boxed{4.2 \ (5.1)}$
<a id="4_2"></a>

**Последовательность де-Брейна $(n, k)$ -** последовательность из элементов множества длины $k$, что все ее подотрезки длины $n$ различны, и встречаются все возможные $k^n$ вариантов. Длина - $k^n + n - 1$  
**Граф де-Брейна $(n, k)$ -** граф на $k^{n - 1}$ вершинах (всех возможнных слов длины $n - 1$). Из каждой вершины - $k$ ребер в те вершины, которые получаются удалением первого символа и записыванием в конец символа ребра. Например для $(n, 2)$, из вершины $x_1 \dots x_{n - 1}$ ребра в $x_2 \dots x_{n - 1} 0$ и $x_2 \dots x_{n - 1} 1$

> **Существование последовательности де-Брейна $(n, 2)$**  

$\triangle$  
Сведем к доказательству существования эйлерова цикла в графе де-Брейна.  

**Цикл $\to$ Последовательность**  
Каждое из $2 \cdot 2^{n - 1}$ ребер кодирует слово, то есть все $2^n$ слов есть в графе. Если есть цикл, то можно составить последовательность $x_1 \dots x_{n - 1} e_1 \dots e_{2^n}$, в которой с символа $i$, идет слово ребра $1 \le i \le 2^n$. Цикл проходит по всем ребрам и ровно $1$ раз $\implies$ все слова есть.

**Последовательность $\to$ Цикл**  
Аналогично, составляем путь в графе. Этот путь Эйлеров, т.к. проходит по всем ребрам. Путь замкнут, т.к. у всех вершин $\text{indeg } = \text{outdeg } = 2$, так что "застрять" нельзя, только вернуться в начало

Осталось доказать, что эйлеров цикл существует:

- Граф сильно связен (из любого слова можно получить любое за не более чем $n$ ребер)
- $\text{indeg } = \text{outdeg } = 2$, т.к. в каждое состояние $x_2 \dots x_n$ можно прийти из $0 x_2 \dots x_{n - 1}$ и $1 x_2 \dots x_{n - 1}$. Уйти тоже можно по двум числам.  
$\implies$ Граф имеет эйлеров цикл.

Для получения последовательности, записываем первую вершину ($n - 1$) и, идя по циклу, выписываем символы на ребрах (еще $2^n$).

> **Правило "$0$ лучше $1$"**  
> Для случая $\Sigma = \{0, 1\}$ можно строить последовательность жадно. Записываем $n$ единиц, а дальше приписываем тот символ, что не создает дубликатов. Если возможны оба варианта, приоритет отдается нулю


## $\boxed{4.3 \ (5.2)}$
<a id="4_3"></a>

**Планарный граф -** можно изобразить на плоскости без пересечений ребер  
**Плоский граф -** конкретное изображение планарного графа на плоскости  
**Грань -** область, ограниченная ребрами в плоском графе + внешняя, неограниченная грань

> **Формула Эйлера (б/д)**  
> Для плоского графа с $\mathbf{с}$ компонент связности:  
> $$ V - E + F = 1 + \mathbf{с} $$

> **Соотношение между $V$ и $E$ в планарном графе**  
> В связном планарном графа при $|V| \ge 3$:  
> $$ E \le 3V - 6 $$
> $$ 2E \ge 3F $$
> В двудольном графе при $|V| \ge 3$:  
> $$ E \le 2V - 4 $$

$\triangle$  

$\sum_{f \in F} \deg(f) = 2E$

В плоском графе грань ограничена $\ge 3$ ребрами $\implies \deg(f) \ge 3$:

$$ 3F \le \sum \deg(f) = 2E \implies 3F \le 2E \ \blacksquare $$

Подставим $F$ из формулы Эйлера:
$$ 3(E - V + 2) \le 2E $$
$$ E \le 3V - 6 \ \blacksquare $$

В двудольном графе нет нечетных циклов, грань ограничена $\ge 4$ ребрами $\implies \deg(f) \ge 4$:

$$ 4F \le \sum \deg(f) = 2E \implies 2F \le E $$

Подставим $F$ из формулы Эйлера:
$$ 2(E - V + 2) \le E $$
$$ E \le 2V - 4 \ \blacksquare $$

> **Непланарность $K_5$ и $K_{3,3}$**  
> $K_5$ и $K_{3,3}$ непланарны

$\triangle$  
Для $K_5$ используем $E \le 3V - 6$, для $K_{3, 3}$ - $E \le 2V - 4$. Получаем противоречия

**Гомеоморфные графы -** каждый из которых можно свести к одному путем удаления и добавления цепей из вершин степени $2$ $(\boxed{u - v} \to \boxed{u - x_1 - \dots - x_n - v})$

> **Критерий Понтрягина-Куратовского планарности графов (б/д)**  
> Конечный граф является планарным $\Leftrightarrow$ он не содержит подграфа, гомеоморфного $K_5$ или $K_{3, 3}$


## $\boxed{4.4 \ (6.1)}$
<a id="4_4"></a>

**Граф Джонсона $G(n, r, s)$ -** граф $(V, E)$

- $V = \{A \subset \{1, \dots, n\}: |A| = r\}$
- $E = \{(A, B): |A \cap B| = s\}$

> **Характеристики $G(n, n/2, n/4)$**  
> 
> - Кликовое число  
>     - $\le n - 1$ всегда
>     - $= n - 1$ если $\exists$ матрица Адамара порядка $n$  
> 
> - Количество ребер  
> $$ \frac{1}{2} C_n^{n/2} (C_{n/2}^{n/4})^2 $$  
> 
> - Количество треугольников  
> $$ \frac{|E|}{3} \sum_{x=0}^{n/4} (C_{n/4}^x)^4 = \frac{1}{6} C_n^{n/2} (C_{n/2}^{n/4})^2 \sum_{x=0}^{n/4} (C_{n/4}^{x})^4 $$

$\triangle$  
**1.**  

Сопоставим характеристический вектор каждой вершине. В нем $\frac{n}{2}$ единиц и столько же минус единиц. Тогда $(\vec{v}, \bold{1}) = 0$, получается что все вектора лежат в $\bold{1}^{\perp}$, его $\dim = n - 1$.  
$A \cap B, A \setminus B, B \setminus A, V \setminus (A \cup B)$ имеют мощность по $n/4$, поэтому скалярное произведение векторов двух смежных вершин равно нулю, а значит смежных вершин $\le n - 1$.
Гипотеза Адамара гласит, что $\exists$ матрица Адамара порядка $4k \ \forall k \in \mathbb{N}$.  
Она равносильна тому, что $\omega(G(n, n/2, n/4)) = n - 1$. Рассматриваем нормальную форму матрицы, игнорируем первую строку и первый столбец из единиц, получаем закодированную клику размера $n - 1$.

**2.**  

Граф регулярный $\implies$ $2|E| = |V| \cdot \deg(v)$  

- $|V| = C_n^{n/2}$  
- $\deg(v) = C_{n/2}^{n/4} \cdot C_{n/2}^{n/4}$, т.к. с каждым соседом ровно $n/4$ общих вершин, и $n/4$ различных вершин

$\implies |E| = \frac{1}{2} C_n^{n/2} (C_{n/2}^{n/4})^2$

**3.**  

Чтобы найти количество треугольников, нужно для каждого ребра $(A, B)$ посчитать количество вершин $C$, смежных с обоими концами ребра просуммировать это и поделить на $3$, так как каждый треугольник посчитан для каждого из своих $3$ ребер.

Рассмотрим $(A, B)$. $|A \cap B| = n/4$. Разобьем все вершины на 4 части:

- $A \cap B$ (мощность $n/4$)
- $A \setminus B$ (мощность $n/4$)
- $B \setminus A$ (мощность $n/4$)
- $V \setminus (A \cup B)$ (мощность $n/4$)

Пусть $C$ - общая соседка $A$ и $B$. Тогда для нее выполнено:  
- $|C \cap A| = n/4$
- $|C \cap B| = n/4$
- $|C|= n/2$

Обозначим за $x := |C \cap (A \cap B)|$, $x$ пробегает от $0$ до $n/4$.

- Из $A \cap B$ берем $C_{n/4}^x$
- Из $A \setminus B$ берем $C_{n/4}^{n/4 - x}$
- Из $B \setminus A$ берем $C_{n/4}^{n/4 - x}$
- Из $V \setminus (A \cup B)$ осталось набрать $n/2 - (x + (n/4 - x) + (n/4 - x)) = x$ элементов. Это $C_{n/4}^x$ вариантов

Количество способ выбрать $C$ - произведение, получаем $(C_{n/4}^x)^4$

Тогда, количество общих соседей для одного ребра:
$$ \sum_{x = 0}^{n/4} \left( C_{n/4}^x \right)^4 $$


## $\boxed{4.5}$

> **Соотношения между хроматическим числом, числом независимости, кликовым числом и максимальной степенью вершины**  
> $\chi(G) \ge \omega(G)$  (наибольшая клика)  
> $\chi(G) \ge \frac{|V|}{\alpha(G)}$  (наибольшее независимое множество)  
> $\chi(G) \le \Delta(G) + 1$  (наибольшая степень вершины)  

$\triangle$  
**1.**  
Очевидно

**2.**  
$|V| = \sum |V_i| \le \chi(G) \cdot \alpha(G)$, где $V_i$ - разбиения каждого цвета, они независимые множества

**3.**  
Обычный жадный алгоритм. $\forall v \in V, \deg v \le \Delta(G)$ $\implies$ всегда найдется доступный цвет из набора $1, \dots, \Delta(G) + 1$

> **Теорема Брукса (б/д)**  
> Если граф связный, и не является **полным** или **нечетным циклом**, то:  
> $$\chi(G) \le \Delta(G)$$


## $\boxed{4.6}$

> **Эквивалентные определения дерева**  
> Если $|V| = n, |E| = m$, то условия эквивалентны:
> 
> 1. Граф не содержит циклов и связен  (определение дерева)  
> 2. Между любыми двумя вершинами существует единственный простой путь  
> 3. Граф не содержит циклов и $m = n - 1$  
> 4. Граф связен и $m = n - 1$

$\triangle$  

**$1 \implies 2$**  
Связный $\implies$ между любыми $u$ и $v$ существует путь.  
Путь единственен, т.к. иначе был бы цикл.

**$2 \implies 1$**  
Путь между любыми вершинами есть $\implies$ граф связен.  
Циклов нет, т.к. иначе путь был бы не единственен.

>> **Вспомогательная лемма**  
>> В любом дереве $m = n - 1$  

В любом дереве есть вершина степени $1$ (берем максимальный простой путь, его конец). Доказываем по индукции. База очев. Пусть равенство верно для всех деревьев на $n - 1$ вершинах. Дерево на $n$ вершинах - это шаг индукции и $+ 1$ ребро и $+ 1$ вершина. Равенство выполнено
***

**$3 \implies 1$**  

Предположим, что есть $k$ компонент связности. Для каждой выполнено равенство, суммируем по всем вершинам и ребрам, результат тоже подчиняется равенству. Тогда:

$$ n - k = n - 1 \implies k = 1 $$

**$4 \implies 1$**  

Предположим есть циклы, удалим $x$ ребер до состояния остовного дерева. Ребер изначально было $n - 1$, стало $n - 1$ $\implies$ $x = 0$ 

**$1 \implies 3$** и **$1 \implies 4$**  
По лемме тривиальны


## $\boxed{4.7}$
<a id="4_7"></a>

> **Количество ребер в $G(n, p)$**  
> 
> - При $n^2 p \to 0$, а.п.н.:  
> $$ |E| = 0 $$  
> - При $n^2 p \to \infty$, а.п.н.:  
> $$ |E| \sim \mathbb{E}|E| $$

$\triangle$  
Сразу считаем матожидание:  
$$ \mathbb{E}|E| = p \cdot C_n^2 = p \cdot \frac{n(n-1)}{2} \sim \frac{n^2 p}{2} $$

**1.** $n^2 p \to 0$  

$$ \mathbb{E} |E| \sim \frac{n^2 p}{2} \to 0 $$

По неравенству Маркова:  
$$ \mathbb{P} (|E| \ge 1) \le \frac{\mathbb{E}|E|}{1} \to 0 $$

**2.** $n^2 p \to \infty$  

$$ \text{Var} |E| = \mathbb{E} |E|^2 - (\mathbb{E} |E|)^2$$

Обозначим количество мест для ребер $N = C_n^2$  
Вычисляем квадрат матожидания:  

$$ (\mathbb{E} |E|)^2 = \left( \sum_{i = 1}^{N} p \right)^2 = N^2 p^2 $$

Вычисляем матожидание квадрата:

$$ |E|^2 = \left( \sum_{i = 1}^N \xi_i \right) \left( \sum_{j = 1}^N \xi_j \right) = \sum_{i = 1}^N \sum_{j = 1}^N \xi_i \xi_j $$

$$ \mathbb{E}[|E|^2] = \sum_{i = 1}^N \sum_{j = 1}^N \mathbb{E}[\xi_i \xi_j] $$

- Когда $i = j$:  
  По определению индикатора:  
$$ \mathbb{E}[\xi_i^2] = \mathbb{E}[\xi_i] = p $$ 

*Вклад в сумму: $Np$*

- Когда $i \neq j$:  
  Ребра появляются независимо друг от друга, поэтому:  

$$ \mathbb{E}[\xi_i \xi_j] = \mathbb{E}\xi_i \cdot \mathbb{E}\xi_j = p \cdot p = p^2 $$

*Вклад в сумму: $(N^2 - N)p^2$*

$$ \mathbb{E}[|E|^2] = Np + N^2p^2 - Np^2 $$

Тогда дисперсия:

$$ \text{Var}(|E|) = C_n^2 (p - p^2) $$

Неравенство Чебышева:
$$ \mathbb{P} (\big||E| - \mathbb{E}|E| \big| \ge t) \le \frac{\text{Var} (|E|)}{t^2} $$

Возьмем $t = \varepsilon \mathbb{E}|E|$, подставим асимптотики:  

$$ \frac{\text{Var} (|E|)}{(\varepsilon \mathbb{E}|E|)^2} \sim \frac{\varepsilon^{-2} \frac{n^2 p}{2}}{(\frac{n^2 p}{2})^2} \sim \frac{2 \varepsilon^{-2}}{n^2 p} $$

По условию $n^2 p \to \infty$ $\implies$ правая часть стремится к $0$:

$$ \mathbb{P} \left( \big||E| - \mathbb{E}|E| \big| \ge \varepsilon \mathbb{E}|E| \right) \to 0 $$

То есть $\forall \varepsilon > 0$:

$$ \mathbb{P} \left( \frac{\big||E| - \mathbb{E}|E| \big|}{\mathbb{E}|E|} < \varepsilon \right) \to 1 $$

$$ \frac{|E|}{\mathbb{E} |E|} \xrightarrow{\mathbb{P}} 1 \Leftrightarrow |E| \sim \mathbb{E} |E| $$


## $\boxed{4.8}$
<a id="4_8"></a>

**Гиперграф -** пара $(V, E)$, где $E \subset 2^V$  
**$k$ - однородный гипеграф -** $\forall e \in E: |e| = k$  
**$h(n, r, s)$ -** максимальное $h$, что $\exists$ $r$ - однородный гиперграф на $n$ вершинах с $h$ ребрами, что мощность пересечения любых двух ребер $\le s$  
**$f(n, r, s)$ -** максимальное $f$, что $\exists$ $r$ - однородный гиперграф на $n$ вершинах с $f$ ребрами, что мощность пересечения любых двух ребер $\ge s$  
**$m(n, r, s)$ -** максимальное $m$, что $\exists$ $r$ - однородный гиперграф на $n$ вершинах с $m$ ребрами, что мощность пересечения любых двух ребер $\neq s$  

Таким образом, $m(n, r, s) = \alpha(G(n, r, s))$

> **Линейно-алгебраическая оценка для $m(n, 3, 1)$**  
> $$ m(n, 3, 1) \le n $$  

$\triangle$  
Сопоставляем харакетристические векторы, рассматриваем пространство $\mathbb{Z}_2^n$. Докажем, что они независимы.

$(v_i, v_i) = |A_i| = 3 = 1 \pmod 2$  
$(v_i, v_j) = 0 \pmod 2$ (т.к. разрешены пересечения только $0$ или $2$)

Рассмотрим нулевую линейную комбинацию:

$$ \sum_{i = 1}^m c_i v_i = 0 $$

$$ \left(\sum_{i = 1}^m c_i v_i, v_j \right) = 0 $$

$$ c_j (v_j, v_j) + \sum_{i \neq j} c_i (v_i, v_j) = 0 $$

Из выводов в начале:

$$ c_j \cdot 1 + \sum_{i \neq j} c_i \cdot 0 = 0$$

$$ c_j = 0 \quad \forall j $$

То есть любая нулевая комбинация тривиальна, значит векторы линейно независимы $\implies$ $m(n, 3, 1) \le \dim(\mathbb{Z}_2^n) = n$


## $\boxed{4.9}$

**Кнезеровский граф $KG_{n, r}$ -** $G(n, r, 0)$. Степень каждой вершины соответственно $C_{n - r}^r$

*\*Далее предполагается, что $r \le \frac{n}{2}$, иначе $|E| = 0$, получается набор изолированных вершин*

Нижние оценки на кликовое число и число независимости:

> **Оценка на кликовое число**  
> $$ \omega(KG_{n, r}) \le \left\lfloor \frac{n}{r} \right\rfloor $$

Очев

> **Теорема ЭКР, частный случай для оценки на число независимости (б/д)**  
> $$ \alpha(KG_{n, r}) \le C_{n - 1}^{r - 1} $$
> *\*Равенство достигается в случае "цветка" - фиксируем один элемент, и берем все $r$-элементные множества, его содержащие*

> **Теорема ЭКР, общий вид (б/д)**  
> Если $\mathcal{F}$ - система $r$-элементных подмножеств $n$-элементного множества, и любые два пересекаются по не менее чем $s$ элементам, то:
> $$ |\mathcal{F}| \le C_{n - s}^{r - s}  $$

> **Нижняя оценка на хроматическое число**   
> $$ \chi(KG_{n, r}) \ge \frac{|V|}{\alpha} \ge \frac{C_n^r}{C_{n - 1}^{r - 1}} = \frac{n}{r} $$

**Примеры KG графов:**

- $KG_{n, 1}$ - $K_n$
- $KG_{5, 2}$ - граф Петерсена


## $\boxed{4.10}$

> **Верхняя оценка хроматического числа**  
> $$ \chi(KG_{n, r}) \le n - 2r + 2 $$

$\triangle$  
Красим все еще не покрашенные вершины, содержащие элемент $k$, в цвет $k$, где $k$ последовательно пробегает значения $1, 2, \dots, n - 2r + 1$. Остались вершины, содержащие элементы из $[n - 2r + 2, n]$. Мощность остатка равна $n - (n - 2r + 2) + 1 = 2r - 1$, значит все оставшиеся будут пересекаться хотя бы по $1$ элементу $\implies$ могут иметь общий цвет, т.к. ребер между ними нет.  
Итого: $\chi(KG_{n, r}) \le n - 2r + 1 + 1 = n - 2r + 2$

> **Теорема Ловаса (б/д)**  
> $$ \chi(KG_{n, r}) = n - 2r + 2 $$

---

## $\boxed{5.1}$

Дополнен пункт [4.2](#4_2)


## $\boxed{5.2}$

Дополнен пункт [4.3](#4_3)


## $\boxed{5.3}$

**Вершинная связность -** минимальное количество вершин, которое нужно удалить из графа, чтобы он стал несвязным или превратился в изолированную вершину

$$ \kappa(G) = \min_{S \subset V} \{ |S| \big| \ G \setminus S \text{ несвязен или тривиален} \} $$

> **Признак Эрдеша-Хватала (б/д)**  
> Связный граф с $|V| \ge 3$ гамильтонов, если:
> $$ \kappa(G) \ge \alpha(G) $$

> **Соотношение между $\kappa$ и количеством общих соседей**  
> Если $(v, w) \notin E$ и $f$ - количество общих соседей, то:  
> $$ \kappa(G) \ge \min_{v, w \in V} f(v, w) $$


## $\boxed{5.4}$
<a id="5_4"></a>

> **Оценки на $n!$ и $C_n^k$**  
> $$ n^n e^{-n + 1} \le n! \le n^{n + 1} e^{-n + 1} $$
> $$ C_n^k \le \frac{n^k}{k!} $$

$\triangle$  
**1.**  
Функция $\ln x$ монотонно возрастает:  
$$ \int_1^n \ln x \ dx \le \sum_{k = 1}^n \ln k = \ln n! \le \int_1^n \ln x \ dx + \ln n $$

Вычисляем интеграл:  
$$ \int_1^n \ln x \ dx = \Big|\Big| \text{По частям} \Big|\Big| = (x \ln x - x) \Big|_1^n = (n \ln n - n) - (1 \cdot 0 - 1) = n \ln n - n + 1 $$

Подстановляем в неравенство:
$$ n \ln n - n + 1 \le \ln n! \le n \ln n - n + 1 + \ln n \qquad \boxed{\ ! \ } $$

Возводим $e$ в степень частей неравенства, получаем искомое:
$$ n^n e^{-n + 1} \le n! \le n^{n + 1} e^{-n + 1} $$

**2.**  
$$ C_n^k = \frac{n(n - 1)(n - 2) \dots (n - k + 1)}{k!} $$

Все $k$ множителей в числителе $\le n$ $\implies$ тривиально

> **Оценки для $C_{2n}^{n}$ с помощью комбинаторных тождеств**  
> $$ \frac{4^n}{2n + 1} \le C_{2n}^n \le 4^n $$

$\triangle$  

**Оценка сверху**  

$$ C_{2n}^n \le \sum_{k = 0}^{2n} C_{2n}^k = (1 + 1)^{2n} = 4^n$$

**Оценка снизу**  

$$ C_{2n}^n = \max_{0 \le k \le 2n} C_{2n}^k \implies (2n + 1) \cdot C_{2n}^n \ge \sum_{k = 0}^{2n} C_{2n}^k = 4^n $$

> **Формула Стирлинга (б/д)**  
> $$ n! \sim \sqrt{2 \pi n} \frac{n^n}{e^n}$$

> **Асимптотика $C_{2n}^{n}$**  
> $$ C_{2n}^{n} \sim \frac{4^n}{\sqrt{\pi n}} $$

$\triangle$  
$$ C_{2n}^n = \frac{(2n)!}{(n!)^2} $$

По формуле Стирлинга, числитель:  
$$ (2n)! \sim \sqrt{2\pi (2n)} \left(\frac{2n}{e}\right)^{2n} = \sqrt{4\pi n} \frac{(2n)^{2n}}{e^{2n}} $$

Знаменатель:  
$$ (n!)^2 \sim \left( \sqrt{2\pi n} \left(\frac{n}{e}\right)^n \right)^2 = 2\pi n \frac{n^{2n}}{e^{2n}} $$

Итог:  
$$ C_{2n}^n \sim \frac{\sqrt{4\pi n} \cdot 2^{2n} \frac{n^{2n}}{e^{2n}}}{2\pi n \cdot \frac{n^{2n}}{e^{2n}}} = \frac{2\sqrt{\pi n} \cdot 4^n}{2\pi n} = \frac{4^n}{\sqrt{\pi n}} $$


## $\boxed{5.5}$

> **Асимптотика $\ln n!$ (без Стирлинга)**  
> $$ \ln n! = n \ln n - n + O(\ln n) $$

$\triangle$  
Из пункта [5.4](#5_4) имеем:  
$$ n \ln n - n + 1 \le \ln n! \le n \ln n - n + 1 + \ln n $$

Из этого следует формула асимптотики

> **Асимптотика $\sqrt[n]{n!}$ (без Стирлинга)**  
> $$ \sqrt[n]{n!} \sim \frac{n}{e} $$

$\triangle$  
Равенство из предыдущего пункта разделим на $n$:
$$ \frac{1}{n} \ln n! = \frac{1}{n} (n \ln n - n + O(\ln n)) $$
$$ \ln (n!)^{\frac{1}{n}} = \ln n - 1 + O\left(\frac{\ln n}{n}\right) $$

Экспоненцируем обе части:
$$ \sqrt[n]{n!} = \exp\left( \ln n - 1 + O\left(\frac{\ln n}{n}\right) \right) $$
$$ \sqrt[n]{n!} = e^{\ln n} \cdot e^{-1} \cdot e^{O(\frac{\ln n}{n})} $$

$o(1) \supset O(\frac{\ln n}{n}) \implies$ $e^{O(\frac{\ln n}{n})} \to e^0$

$$ \sqrt[n]{n!} = n \cdot e^{-1} \cdot (1 + o(1)) \sim \frac{n}{e} $$


## $\boxed{5.6}$
<a id="5_6"></a>

> **Асимптотика $C_n^k$ при $k^2 = o(n)$**  
> $$ C_n^k \sim \frac{n^k}{k!} $$

$\triangle$  

$$ C_n^k = \frac{n(n - 1) \dots (n - k + 1)}{k!} = \frac{n^k}{k!} \prod_{j = 0}^{k - 1} \left(1 - \frac{j}{n} \right) $$

$$C_n^k = \frac{n^k}{k!} \cdot e^{\sum_{j = 0}^{k - 1} \ln \left(1 - \frac{j}{n}\right)} $$

Раскладываем по Тейлору при $x \to 0$:

$$ \frac{n^k}{k!} \cdot e^{\sum_{j = 0}^{k - 1} \left[ - \frac{j}{n} + O \left( \frac{j^2}{n^2} \right) \right] } $$

$$ = \frac{n^k}{k!} \cdot e^{- \frac{k(k - 1)}{2n} + O \left( \frac{k^3}{n^2} \right)} $$

Т.к. $\frac{k^3}{n^2} = \frac{k^2}{n} \cdot \frac{k}{n} \to 0$, то:

$$ C_n^k = \frac{n^k}{k!} \cdot e^{o(1)} \sim \frac{n^k}{k!} \cdot e^0 = \frac{n^k}{k!} $$

> **Асимптотика $C_n^k$ при $k$ линейном относительно $n$**  
> При $k \sim \alpha n$, $\alpha \in (0, 1)$ фиксировано:
> $$ \ln C_n^k = n H(\alpha) + O(\ln n) $$
> *\*$H(\alpha) = - (\alpha \ln \alpha + (1 - \alpha) \ln (1 - \alpha))$*

$\triangle$  
Используем оценку $\ln m! = m \ln m - m + O(\ln m)$
$$ \ln C_n^k = \ln n! - \ln k! - \ln (n - k)! $$


1. **Слагаемые $m \ln m$**  
    $$ n \ln n - k \ln k - (n - k) \ln (n - k) $$

    $$ n \ln n - k \left( \ln n + \ln \frac{k}{n} \right) - (n - k) \left( \ln n + \ln \frac{n - k}{n} \right) $$

    Сгруппируем слагаемые с $\ln n$:
    $$ \ln n \cdot \underbrace{(n - k - (n - k))}_{0} - k \ln \frac{k}{n} - (n - k) \ln \frac{n - k}{n} $$

    $$ -n \left( \frac{k}{n} \ln \frac{k}{n} + \frac{n - k}{n} \ln \frac{n - k}{n} \right) = n H\left(\frac{k}{n}\right) $$

    Так как $\frac{k}{n} = \alpha + O(\frac{1}{n})$, получаем $n H(\alpha) + O(1)$.

2. **Слагаемые $(-m)$**
    $$ (-n) - (-k) - (-(n - k)) = -n + k + n - k = 0 $$

3. **Остатки $(O(\ln m))$**
    $$ O(\ln n) + O(\ln k) + O(\ln (n - k)) = O(\ln n) $$


## $\boxed{5.7}$
<a id="5_7"></a>

> **Асимптотика $C_{2n}^{n} \ / \ C_{2n}^{n - x}$**  
> Если $x = o(n)$ и $x \ge 0$, то:
> $$ \frac{C_{2n}^n}{C_{2n}^{n - x}} = \exp\left( \frac{x^2}{n} + O\left(\frac{x^3}{n^2}\right) \right) $$

$\triangle$  
Распишем биномиальные коэффициенты через факториалы:

$$ \frac{C_{2n}^n}{C_{2n}^{n - x}} = \frac{(2n)!}{(n!)^2} \cdot \frac{(n - x)! (n+x)!}{(2n)!} = \frac{(n - x)! (n+x)!}{n! n!} $$

Сгруппируем факториалы для сокращения:

$$ \frac{(n + x)!}{n!} = \prod_{i = 1}^x (n + i) $$
$$ \frac{(n - x)!}{n!} = \prod_{i = 1}^x \frac{1}{n - i + 1} $$

Объединим в одно произведение:
$$ \frac{C_{2n}^n}{C_{2n}^{n - x}} = \prod_{i = 1}^x \frac{n+i}{n - i + 1} $$

Прологарифмируем выражение:
$$ L = \ln \left( \prod_{i = 1}^x \frac{n+i}{n - i + 1} \right) = \sum_{i = 1}^x \left( \ln(n+i) - \ln(n - i + 1) \right) $$

Вынесем $n$ под знаком логарифма:
$$ \ln(n+i) = \ln \left( n \left( 1 + \frac{i}{n} \right) \right) = \ln n + \ln \left( 1 + \frac{i}{n} \right) $$
$$ \ln(n - i + 1) = \ln \left( n \left( 1 - \frac{i-1}{n} \right) \right) = \ln n + \ln \left( 1 - \frac{i-1}{n} \right) $$

Подставим в сумму ($\ln n$ сокращаются):
$$ L = \sum_{i = 1}^x \left[ \ln \left( 1 + \frac{i}{n} \right) - \ln \left( 1 - \frac{i-1}{n} \right) \right] $$

Так как $x = o(n)$, то для всех $i \le x$ выполняется $\frac{i}{n} \to 0$. Используем разложение Тейлора $\ln(1+t) = t - \frac{t^2}{2} + O(t^3)$:

- $\ln (1 + \frac{i}{n}) = \frac{i}{n} - \frac{i^2}{2n^2} + O(\frac{i^3}{n^3})$
- $\ln (1 - \frac{i-1}{n}) = -\frac{i-1}{n} - \frac{(i-1)^2}{2n^2} + O(\frac{i^3}{n^3})$

Подставляем разложения в сумму.
Линейная часть:
$$ \frac{i}{n} - \left( -\frac{i-1}{n} \right) = \frac{2i - 1}{n} $$

Квадратичная часть:
$$ -\frac{i^2}{2n^2} - \left( -\frac{(i-1)^2}{2n^2} \right) = \frac{-2i + 1}{2n^2} = O\left(\frac{i}{n^2}\right) $$

Тогда $L$ выглядит так:

$$ L = \sum_{i = 1}^x \left( \frac{2i - 1}{n} + O\left(\frac{i}{n^2}\right) + O\left(\frac{i^3}{n^3}\right) \right) $$

Сумма линейного члена:

$$ \sum_{i = 1}^x \frac{2i - 1}{n} = \frac{1}{n} \left( 2 \sum_{i = 1}^x i - \sum_{i = 1}^x 1 \right) = \frac{1}{n} \left( 2 \frac{x(x+1)}{2} - x \right) = \frac{1}{n} (x^2 + x - x) = \frac{x^2}{n} $$

Оценка остаточных членов:

$$ \sum_{i = 1}^x O\left(\frac{i}{n^2}\right) = O\left(\frac{1}{n^2} \sum_{i = 1}^x i\right) = O\left(\frac{x^2}{n^2}\right) $$

$$ \sum_{i = 1}^x O\left(\frac{i^3}{n^3}\right) = O\left(\frac{1}{n^3} \sum_{i = 1}^x i^3\right) = O\left(\frac{x^4}{n^3}\right) $$

Так как $x \ge 1$, то $x^2 \le x^3$, значит $O(x^2/n^2) \subset O(x^3/n^2)$  
$\frac{x^4}{n^3} = \frac{x^3}{n^2} \cdot \frac{x}{n} = o\left(\frac{x^3}{n^2}\right)$  

Т.е. суммарная ошибка укладывается в $O(x^3/n^2)$

Итог:

$$ \frac{C_{2n}^n}{C_{2n}^{n - x}} = e^L = \exp\left( \frac{x^2}{n} + O\left(\frac{x^3}{n^2}\right) \right) $$


## $\boxed{5.8}$

> **Теорема Боллобаша (б/д)**  
> 1. Если $p = n^{-\alpha}$, $\alpha \in (\frac{5}{6}, 1)$, то $\exists$ $u(n, \alpha)$, что а.п.н:  
> $$ u \le \chi(G(n , p)) \le u + 3 $$
> 
> 2. Если $p = \frac{1}{2}$, то $\exists$ $\varphi = o(\frac{n}{2 \log_2 n})$, что а.п.н:  
> $$ \Big|\chi(G) - \frac{n}{2 \log_2 n} \Big| \le \varphi(n)$$

> **Оценка $\chi(G)$ при $p = o(\frac{1}{n^2})$**  
> $$ \chi(G) = 1 $$

$\triangle$  
Асимптотически почти наверное ребер нет, доказано в пункте [4.7](#4_7), поэтому $\chi(G) = 1$

> **Оценка $\chi(G)$ при $p = o(1/n)$**  
> $$ \chi(G) \le 2 $$

$\triangle$  
Пусть $N_k$ - число простых циклов в графе длины $k$, $N_{all} = \sum_{k = 0}^n N_k$. Т.к. есть $k!$ перестановок, и каждую можно начать в любой из $k$ вершин, и пройти в двух направлениях, то:  

$$ \mathbb{E} N_k = C_n^k \frac{k!}{2 k} p^k = C_n^k \frac{(k - 1)!}{2} p^k $$
$$ \mathbb{E} N_{all} = \sum_{k = 3}^n C_n^k \frac{(k - 1)!}{2} p^k \le \sum_{k = 3}^n \frac{n^k}{k!} \frac{(k - 1)!}{2} p^k = \sum_{k = 3}^n \frac{(np)^k}{2 k} \le \sum_{k = 3}^n (np)^k $$

$p = o(\frac{1}{n})$ $\implies$ $np \to 0$. Сумма - убывающая геометрическая прогрессия с первым членом $(np)^3$  

$$ \mathbb{E}N_{all} \le \sum_{k = 3}^n (np)^k \le \sum_{k = 3}^{\infty} (np)^k = \frac{(np)^3}{1 - np} \sim (np)^3 \to 0 $$

По неравенству Маркова
$$ \mathbb{P} (N_{all} \ge 1) \to 0 $$

Граф без циклов - несколько деревьев, т.е. двудольный $\implies \chi(G) \le 2$


## $\boxed{5.9}$
<a id="5_9"></a>

> **Точное значение для $m(n, 3, 1)$**  
> $$
> m(n, 3, 1) = \begin{cases}
>   n, & n \equiv 0 \quad \pmod 4 \\
>   n - 1, & n \equiv 1 \quad \pmod 4 \\
>   n - 2, & n \equiv 2, 3 \pmod 4
> \end{cases}
> $$

$\triangle$  
Предъявим явный способ построения и оценку по индукции. Дробим множество на подмножества размера $4$, в каждом берем все возможные $C_4^3$ трехэлементных подмножеств, они все пересекаются по $2$ элементам. Если остаток размера $1$ или $2$, игнорируем, а если $3$ - получаем еще одно подмножество. Индукция так же: база для ${0, 1, 2, 3, 4}$, дальше переход с шагом в $4$


## $\boxed{5.10}$

**Хроматическое число пространства $\chi(\mathbb{R}^n)$ -** наименьшее число цветов для раскраски всех точек $\mathbb{R}^n$, что никакие две точки на расстоянии $1$ не покрашены в один цвет:
$$ \chi(\mathbb{R}^n) = \min \{k : \mathbb{R}^n = \bigcup_{i}^k V_i \ \big| \ \forall i, \forall x, y \in V_i \ |x - y| \neq 1 \} $$

**Дистанционный граф -** граф $(\mathbb{R}^n, E_r)$, где $E_r = \{ \{x, y\} : |x - y| = r \}$ для некотрого фиксированного $r$  

**Связь между дистанционным графом и $\chi(\mathbb{R}^n)$**  
$$ \chi(\mathbb{R}^n) = \chi(G(\mathbb{R}^n, E_1)) $$

> **Хроматическое число конечно для любой размерности**  

$\triangle$  
Для конечности, докажем грубую оценка:  

$$ \chi(\mathbb{R}^n) \le (4\sqrt{n})^n $$  

Разобьем $\mathbb{R}^n$ на маленькие полуинтервальные $n$-мерные кубики со стороной $\varepsilon = \frac{1}{2\sqrt{n}}$. Диагональ куба равна $\varepsilon\sqrt{n} = \frac{1}{2} < 1$. Внутри одного кубика нет пары точек на расстоянии $1$ $\implies$ весь кубик можно красить в один цвет. Куб со стороной $2$ по одному ребру замощается $\frac{2}{\varepsilon} = 4\sqrt{n}$ кубиками. Всего в большом кубе $(4\sqrt{n})^n$ кубиков, красим все в разные цвета. Получается, что $(4\sqrt{n})^n$ цветов достаточно

> **Оценки $\chi(\mathbb{R}^n)$ (б/д)**  
> 
> - $\chi(\mathbb{R}) = 2$
> - $\chi(\mathbb{R}^2) \in [5, 7]$
> - $\chi(\mathbb{R}^3) \in [6, 15]$
> - При $n \to \infty$:
> $$ \left(\frac{1 + \sqrt{2}}{2} + o(1) \right)^n \le \chi(\mathbb{R}^n) \le (3 + o(1))^n $$
> *\*Более точную нижнюю оценку, $1.239...$ доказал сам лектор, А.М. Райгородский*

---

## $\boxed{6.1}$

Дополнен пункт [4.4](#4_4)


## $\boxed{6.2}$

**Гамильтонов путь -** простой путь, проходящий по всем вершинам  
**Гамильтонов цикл -** замкнутый гамильтонов путь  

> **Теорема Дирака**  
> Если $|V| \ge 3$ и $\deg v \ge \frac{|V|}{2} \ \forall v$, то граф гамильтонов

$\triangle$  
Рассмотрим $v_1 \dots v_k$ - простой путь **максимальной** длины. Все соседи $v_1$ принадлежат этому пути, иначе путь можно было бы удлинить, добавив соседа. Поэтому:

$$ k - 1 \ge \deg(v_1) \ge \frac{n}{2} \implies k \ge \frac{n}{2} + 1 $$

Покажем, что путь можно замкнуть в цикл той же длины.  
Нужно найти такое $i \in \{1, \dots k - 1 \}$, что $(v_1, v_{i + 1}) \in E$ и $(v_i, v_k) \in E$. Это позволит замкнуть путь: $v_1 \to v_{i + 1} \dots v_k \to v_i \dots v_1$

Рассмотрим множества индексов из диапазона $1 \dots k - 1$:
- $S_1 = \{i \ \big| \ (v_1, v_{i + 1}) \in E \}$. Заметим, что $|S_1| = \deg(v_1) \ge \frac{n}{2}$
- $S_k = \{i \ \big| \ (v_k, v_i) \in E \}$. Заметим, что $|S_k| = \deg(v_k) \ge \frac{n}{2}$

$k - 1 < n$ $\implies$ по Дирихле, есть пересечение $\implies$ есть цикл. Осталось показать, что $k = |V|$.

Граф связен. Следовательно, найдется вершина вне цикла, смежная с вершиной из цикла. Тогда путь из нее, а далее по циклу, имеет длину $k + 1$, то есть получаем противоречие, ведь путь брался максимальным $\implies k = |V|$, цикл гамильтонов


## $\boxed{6.3}$

$k = \lfloor an \rfloor \implies k = an - \varepsilon \implies \frac{k}{n} = a + O(\frac{1}{n})$

Теперь работает доказательство из пункта [5.6](#5_6)

**Полиномиальные коэффициенты -** выборка $m$ групп размеров $k_1 , \dots k_m$.
$$ C_n^{k_1 \dots k_m} = \frac{n!}{k_1! k_2! \dots k_m!} $$

**Многомерная энтропия -** При $\alpha_1, \dots, \alpha_m \in (0, 1)$ и $\sum \alpha_i = 1$:
$$ H(\alpha_1, \dots, \alpha_m) = - \sum_{i = 1}^m \alpha_i \ln \alpha_i. $$

> **Асимптотика $C_n^{k_1 \dots k_m}$ при $k$ линейном относительно $n$**  
> Если $\forall i$ $\frac{k_i}{n} \to \alpha_i$, то:  
> $$ \ln C_n^{k_1 \dots k_m} = n H(\alpha_1, \dots, \alpha_m) + O(\ln n). $$


## $\boxed{6.4}$

Буквально содержание пунктов [5.6](#5_6) и [5.7](#5_7)


## $\boxed{6.5}$

**Код Прюфера -** последовательность длины $n - 2$, элементы которой принадлежат $\{1, \dots, n\}$ - множеству вершин дерева

> **Между кодами Прюфера и деревьями на $n$ вершинах есть биекция**  

$\triangle$  
**Дерево $\to$ Код**  

Выбираем листовую вершину $(\deg = 1)$ с минимальным номером. Записываем в код номер ее соседа, вычеркиваем. *Степень любой вершины в дереве на $1$ больше числа вхождений ее номера в код.*

**Код $\to$ Дерево**  

Дан код $k_1 \dots k_{n - 2}$, $k_i \in \{1, \dots n \}$. Для каждого $i \in \{1, \dots n - 2 \}$ берем среди не вычеркнутых вершин $p_i$ с наименьшим номером, чтобы она не встречалась в **оставшейся части** кода (т.е. в `k[i:]`), и созраем ребро $(p_i, k_i)$. Вычеркиваем $p_i$ и $k_i$.  
Оставшиеся две вершины образуют последнее ребро.

> **Формула Кэли**  
> Различных деревьев на $n$ вершинах:
> $$ t_n = n^{n - 2} $$

$\triangle$  
Имеем биекцию с кодами Прюфера. Код имеет длину $n - 2$, состоит из повторяющихся элементов множества длины $n$, значит, кодов $n^{n - 2}$ штук


## $\boxed{6.6}$

**Случайный граф Эрдеша-Реньи $G(n, p)$ -** граф на $n$ вершинах, где каждое из $C_n^2$ ребер проводится с вероятностью $p$, **независимо от остальных!**

> **Неравнество Маркова**  
> Если $X \ge 0$ - случайная величина, то $\forall \ t > 0$:
> $$ \mathbb{P}(X \ge t) \le \frac{\mathbb{E} X}{t} $$

$\triangle$  
Пусть $\mathbb{I} = \{X \ge t\}$ - индикатор. Тогда всегда верно, что $X \ge t \cdot \mathbb{I}$. Возьмем матожидание от обеих частей:
$$ \mathbb{E} X \ge \mathbb{E} [t \cdot \mathbb{I}] = t \cdot \mathbb{P} (X \ge t) $$
Делим на $t$, получаем требуемое

> **Неравенство Чебышева**  
> Если $\mathbb{E} X$ существует и $t > 0$, то:
> $$ \mathbb{P} (|X - \mathbb{E} X| \ge t) \le \frac{\text{Var} X}{t^2} $$

$\triangle$  
Введем  случайную величину $Y = |X - \mathbb{E} X|^2$, применим к ней неравенство Маркова с параметром $t^2$:
$$ \mathbb{P}(Y \ge t^2) \le \frac{\mathbb{E} Y}{t^2} $$

Заметим, что $\{|X - \mathbb{E} X| \ge t \} = \{|X - \mathbb{E} X|^2 \ge t^2 \}$, значит и их вероятности равны, а также $\mathbb{E} Y = \text{Var} X$. Получаем искомое

**Блуждающая величина -** последовательность $\{S_k\}$, где $S_0 = 0$, $S_k = \sum_{i = 1}^k \xi_i$, а $\xi_i = \pm 1$ с вероятностью $\frac{1}{2}$

> **Слабая оценка на вероятность отдаления**  
> $$ \mathbb{P} (S_n \ge a) \le \frac{n}{a^2} $$

$\triangle$  
Так как $\mathbb{E} S_n = \mathbb{E} \sum \xi_i = \sum \mathbb{E} \xi_i = \sum 0 = 0$, то:
$$ \mathbb{P} (S_n \ge a) = \mathbb{P} (S_n - \mathbb{E} S_n \ge a) \le \mathbb{P} (|S_n - \mathbb{E} S_n| \ge a) \le \frac{\text{Var} S_n}{a^2} = \frac{n \cdot (1 - 0)}{a^2} = \frac{n}{a^2} $$

> **Неравенство Хеффдинга**  
> $$ \mathbb{P} (S_n \ge a) \le e^{-\frac{a^2}{2n}} $$

$\triangle$  
Заметим, что при $\lambda > 0$:
$$ \mathbb{P} (S_n \ge a) = \mathbb{P} (\lambda S_n \ge \lambda a) = \mathbb{P} (e^{\lambda S_n} \ge e^{\lambda a}) \le e^{-\lambda a} \cdot \mathbb{E} e^{\lambda S_n} = $$

$$ = e^{-\lambda a} \cdot \mathbb{E} \left(\prod_{i = 1}^n e^{\lambda \xi_i} \right) = e^{-\lambda a} \prod_{i = 1}^n \mathbb{E} e^{\lambda \xi_i} = e^{-\lambda a} \cdot \left(\frac{1}{2} e^{\lambda} + \frac{1}{2} e^{-\lambda} \right)^n $$

Раскладываем экспоненту по Тейлору, видим, что при нечетные члены взаимно сокращаются, а четные - складываются, сокращая $\frac{1}{2}$. Тогда это все равно:

$$ e^{-\lambda a} \left(\sum_{k = 0}^{\infty} \frac{\lambda^{2 k}}{(2 k)!} \right)^n \qquad \bold{(1)}$$

Из того, что $(2 k)! \ge (2 k)!! = 2^k \cdot k!$, следует:

$$ \sum_{k = 0}^{\infty} \frac{\lambda^{2 k}}{(2 k)!} \le \sum_{k = 0}^{\infty} \frac{\lambda^{2 k}}{2^k k!} = e^{\frac{\lambda^2}{2}} $$

Значит:

$$ \bold{(1)} \le e^{-\lambda a + \frac{\lambda^2}{2} n} $$

Положим $\lambda = \frac{a}{n}$ (Такое значение можно найти, если посчитать производную и найти минимум, чтобы оценка была точнее), получаем искомое


## $\boxed{6.7}$

> **Количество треугольников в $G(n, p)$**
> 
> При $np \to 0$, а.п.н.:
> $$ N_{\Delta} = 0 $$
> 
> При $np \to \infty$, а.п.н.:
> $$ N_{\Delta} \sim \mathbb{E} N_{\Delta} $$
> 
> При $p = \frac{c}{n}$ **(б/д)**:
> $$ N_{\Delta} \xrightarrow{d} \text{Pois} \left(\frac{c^3}{6} \right) $$

$\triangle$  

Пусть $N_{\Delta}$ - число треугольников в $G(n, p)$. Сразу считаем матожидание:  

$$ \mathbb{E} N_{\Delta} = C_n^3 p^3 \sim \frac{n^3 p^3}{6} $$

**1.** $np \to 0$  

$$ \mathbb{E} N_{\Delta} \to 0 $$

По неравенству Маркова:
$$ \mathbb{P} (N_{\Delta} \ge 1) \le \frac{\mathbb{E} N_{\Delta}}{1} \to 0 $$

**2.** $np \to \infty$  

$N_{\Delta} = \sum \xi_i$, где $\xi_i$ - индикатор $i$-го треугольника. Дисперсия суммы:  

$$ \text{Var} N_{\Delta} = \sum \text{Var} \xi_i + \sum_{i \neq j} \text{Cov}(\xi_i, \xi_j) $$

Первое слагаемое, т.к. $\xi^2 = \xi$:  

$$ \sum \text{Var} \xi_i = \sum \left[ \mathbb{E} \xi_i^2 - (\mathbb{E} \xi_i)^2 \right] \le \sum \mathbb{E} (\xi_i^2) = \mathbb{E} N_{\Delta} $$

Второе слагаемое:  

$$ \text{Cov}(\xi_i, \xi_j) = \mathbb{E}[\xi_i \xi_j] - \mathbb{E}\xi_i \mathbb{E}\xi_j \le \mathbb{E}[\xi_i \xi_j] $$
  
Если треугольники $i$ и $j$ не имеют общих ребер (могут иметь общие вершины), то события независимы, и ковариация равна $0$. Ненулевой вклад дают пары треугольников, имеющие общее ребро. Такая конфигурация - это 4 вершины и 5 ребер

$$ \mathbb{E} [\xi_i \xi_j] = p^5 $$

Количество пар треугольников $(i, j)$, имеющих ровно одно общее ребро - $C_n^4 = O(n^4)$ (константу $C_4^2$ опускаем, она входит в $O$-большое). Тогда сумма ковариаций:  

$$ \sum_{i \neq j} \text{Cov}(\xi_i, \xi_j) \le \sum_{i \neq j} \mathbb{E}[\xi_i \xi_j] \le O(n^4) \cdot p^5 $$

$$ \text{Var} N_{\Delta} \le \mathbb{E} N_{\Delta} + O(n^4 p^5) $$

Неравенство Чебышева:  
$$ \mathbb{P} \left( \left| N_{\Delta} - \mathbb{E} N_{\Delta} \right| \ge \varepsilon \mathbb{E} N_{\Delta} \right) \le \frac{\text{Var} N_{\Delta}}{(\varepsilon \mathbb{E} N_{\Delta})^2} = \frac{1}{\varepsilon^2} \cdot \frac{\text{Var} N_{\Delta}}{(\mathbb{E} N_{\Delta})^2} $$

Используем полученную ранее оценку дисперсии:  

$$ \frac{\text{Var} N_{\Delta}}{(\mathbb{E} N_{\Delta})^2} \le \frac{\mathbb{E} N_{\Delta}}{(\mathbb{E} N_{\Delta})^2} + \frac{O(n^4 p^5)}{(\mathbb{E} N_{\Delta})^2} = \underbrace{\frac{1}{\mathbb{E} N_{\Delta}}}_{\text{(1)}} + \underbrace{\frac{O(n^4 p^5)}{(\mathbb{E} N_{\Delta})^2}}_{\text{(2)}} $$

**(1)**

$$ \frac{1}{\mathbb{E} N_{\Delta}} \to 0 $$

**(2)**

$$ \frac{O(n^4 p^5)}{(\Theta(n^3 p^3))^2} = \frac{O(n^4 p^5)}{\Theta(n^6 p^6)} = O\left( \frac{n^4 p^5}{n^6 p^6} \right) \to 0 $$

Следовательно, $\forall \varepsilon > 0$:
$$ \mathbb{P} \left( \left| \frac{N_{\Delta}}{\mathbb{E} N_{\Delta}} - 1 \right| \ge \varepsilon \right) \to 0 $$

Асимптотически почти наверное:
$$ N_{\Delta} \sim \mathbb{E} N_{\Delta} $$


## $\boxed{6.8}$

Буквально содержание пунктов [5.9](#5_9) и [4.8](#4_8)


## $\boxed{6.9}$

> **Линейно-алгебраическая оценка для $m(n, 5, 2)$**  
> $$ m(n, 5, 2) \le C_n^2 + C_n^1 $$

$\triangle$  
Также, как с $m(n, 3, 1)$, сопоставим характеристический вектор $v_i$ каждому подмножеству. Рассматриваем их как векторы над полем $\mathbb{Z}_3^n$, потому что в таком поле $(v_i, v_i) \equiv 2 \pmod 3$, а $(v_i, v_j) \equiv 0$ или $1 \pmod 3$

Новый трюк: каждому $v_i$ сопоставляем многочлен $P_i(y)$ степени $2$ $(y \in \mathbb{Z}_3^n)$:

$$ P_i(y) = (v_i, y)((v_i, y) - 1) $$

Для такого хитрого многочлена:

- $P_i(v_i) = 2 \cdot (2 - 1) = 2 \neq 0$
- $P_i(v_j) = 0$, т.к $(v_i, v_j) \in \{0, 1 \} \implies$ одна из скобок равна $0$

Рассмотрим базис $\mathbb{Z}_3 [y_1, \dots, y_n]$, чтобы найти размерность $m$:  

- $y_i y_j$ ($C_n^2$ шт)
- $y_i^2$ ($n$ шт)
- $y_i$ ($n$ шт)

Свободных коэффициентов не будет, как видно из формулы. Также, из-за того, что $x^2 = x \ \forall x \in \{0, 1 \}$, можно линеаризовать многочлены, отбросив $n$ лишних векторов

**Итог:** $m(n, 5, 2) \le C_n^2 + n = C_n^2 + C_n^1$

Осталось доказать линейную независимость. Берем линейную комбинацию:

$$ \sum_{i = 1}^m c_i P_i(y) = 0 \quad \forall y $$

Вместо $y$ подставим некий $v_k$:

$$ \sum_{i = 1}^m c_i P_i(v_k) = c_k P_k(v_k) + \sum_{i \neq k} c_i P_i(v_k) $$

Здесь первое слагаемое ненулевое, равно $2$, а остальные - нулевые. Поэтому: 

$$ c_k \cdot 2 \equiv 0 \pmod 3 \implies c_k = 0 \quad \forall k $$

Значит, нулевая комбинация тривиальна $\implies$ $P_1, \dots P_m$ линейно независимы.

> **Асимптотическая неулучшаемость**  

$\triangle$  
Асимптотически улучшить оценку $C_n^2 + C_n^1 \sim \frac{n^2}{2}$ нельзя, т.к. есть контр-пример:  
Все множества содержат $3$ фиксированных элемента, а остальные $2$ добираются $C_{n-3}^2 \sim \frac{n^2}{2}$ способами

---
